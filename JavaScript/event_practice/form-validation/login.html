<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/3f2c09a521.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./style.css">
    <style>
        .alert {
            display: none;
        }
    </style>
</head>

<body>
    <div class="outer-box">
        <div class="round-1"></div>
        <div class="round-2"></div>
        <div class="round-3"></div>
        <div class="round-4"></div>
        <div class="round-5"></div>
        <div class="round-6"></div>

        <div class="container rounded-4">
            <h2 class="text-center text-light mb-4">Login Form</h2>
            <form action="" class="d-flex flex-column text-light gap-4">
                <div class="d-flex flex-column gap-4">
                    <div>
                        <input type="text" id="uname" placeholder="Enter Username">
                        <p id="usernameError" class="error"></p>
                    </div>
                    <input type="text" id="pwd" placeholder="Enter Password">
                </div>
                <div class="d-flex flex-column gap-2">
                    <button type="submit" id="submit" class="btn fw-semibold rounded-5 w-75 mt-3">Submit</button>
                    <div class="mt-2">Don't have an account? <a href="./index.html" class="text-light fw-semibold">Register</a></div>
                </div>
            </form>
        </div>
        <div class="successMsg p-2 rounded bg-light w-25" id="successMessage">
            <i class="fa-solid fa-circle-check fa-lg text-success"></i> Login successfully
        </div>

    </div>

    <script>
        // Select DOM elements
        const uname = document.getElementById("uname");
        const pwd = document.getElementById("pwd");
        const msg = document.getElementById("error-msg");

        // Parse user data from localStorage
        const users = JSON.parse(localStorage.getItem("user")) || [];
        console.log(users);

        // Add submit event listener to the form
        document.querySelector("form").addEventListener("submit", (e) => {
            e.preventDefault();

            const error = {};

            // Validate input fields
            if (uname.value.trim() == "" || pwd.value.trim() == "") {
                error.required = "* Please enter all fields.";
            } else {
                // Find the user in the stored data
                const foundUser = users.find(user =>
                    user.uname === uname.value.trim() && user.pwd === pwd.value.trim()
                );

                // Check if user was found
                if (!foundUser) {
                    error.validData = "* Please enter valid data.";
                }
            }

            if (error && Object.keys(error).length !== 0) {
                // Display errors by showing elements with the class 'error'
                document.querySelectorAll(".error").forEach((e) => e.style.display = "block");

                // Clear previous error messages
                document.getElementById("usernameError").innerHTML = '';
                //document.getElementById("pwdError").innerHTML = '';

                // Display new error messages
                document.getElementById("usernameError").innerHTML = error.required || error.validData || '';


            } else {
                // Check if the error object is empty or undefined, then add new user
                if (!error || Object.keys(error).length === 0) {
                    // Show success message
                    const successMessage = document.getElementById("successMessage");
                    successMessage.style.display = "block";

                    //hide the message after 3 seconds
                    setTimeout(() => {
                        successMessage.style.display = "none";
                    }, 3000);
                    document.querySelector("form").reset();
                } else {
                    // Hide error elements if no errors are present or error is undefined
                    document.querySelectorAll(".error").forEach((e) => e.style.display = "none");
                }
            }
        });
    </script>

</body>
</html>

